
> sazanami@0.0.3 check
> svelte-kit sync && svelte-check --tsconfig ./tsconfig.json

Loading svelte-check in workspace: c:\Users\toshimi.sato\program\sazanami
Getting Svelte diagnostics...

c:\Users\toshimi.sato\program\sazanami\[32msrc\hooks.server.ts[39m:15:4
[31mError[39m: No overload matches this call.
  Overload 1 of 2, '(context: { headers: Headers; query?: { disableCookieCache?: boolean | undefined; disableRefresh?: boolean | undefined; } | undefined; asResponse?: boolean | undefined; returnHeaders?: false | undefined; }): Promise<...>', gave the following error.
    Object literal may only specify known properties, and 'cookies' does not exist in type '{ headers: Headers; query?: { disableCookieCache?: boolean | undefined; disableRefresh?: boolean | undefined; } | undefined; asResponse?: boolean | undefined; returnHeaders?: false | undefined; }'.
  Overload 2 of 2, '(inputCtx_0: { body?: undefined; } & { method?: "GET" | undefined; } & { query?: { disableCookieCache?: unknown; disableRefresh?: unknown; } | undefined; } & { params?: Record<string, any> | undefined; } & { ...; } & { ...; } & { ...; } & { ...; }): Promise<...>', gave the following error.
    Object literal may only specify known properties, and 'cookies' does not exist in type '{ body?: undefined; } & { method?: "GET" | undefined; } & { query?: { disableCookieCache?: unknown; disableRefresh?: unknown; } | undefined; } & { params?: Record<string, any> | undefined; } & { request?: Request | undefined; } & { ...; } & { ...; } & { ...; }'. 
[36m			headers: event.request.headers,
			[35mcookies[36m: event.cookies
		});[39m

c:\Users\toshimi.sato\program\sazanami\[32msrc\hooks.server.ts[39m:25:3
[31mError[39m: Type '{ session: { id: string; createdAt: Date; updatedAt: Date; userId: string; expiresAt: Date; token: string; ipAddress?: string | null | undefined; userAgent?: string | null | undefined; }; user: { ...; }; } | null' is not assignable to type '{ id: string; createdAt: Date; updatedAt: Date; userId: string; expiresAt: Date; token: string; ipAddress?: string | null | undefined; userAgent?: string | null | undefined; } | null'.
  Type '{ session: { id: string; createdAt: Date; updatedAt: Date; userId: string; expiresAt: Date; token: string; ipAddress?: string | null | undefined; userAgent?: string | null | undefined; }; user: { ...; }; }' is missing the following properties from type '{ id: string; createdAt: Date; updatedAt: Date; userId: string; expiresAt: Date; token: string; ipAddress?: string | null | undefined; userAgent?: string | null | undefined; }': id, createdAt, updatedAt, userId, and 2 more. 
[36m		// Add session to locals for easy access in routes
		[35mevent.locals.session[36m = session;
		event.locals.user = session?.user;[39m

c:\Users\toshimi.sato\program\sazanami\[32msrc\hooks.server.ts[39m:26:3
[31mError[39m: Type '{ id: string; createdAt: Date; updatedAt: Date; email: string; emailVerified: boolean; name: string; image?: string | null | undefined; twoFactorEnabled: boolean | null | undefined; } | undefined' is not assignable to type '{ id: string; createdAt: Date; updatedAt: Date; email: string; emailVerified: boolean; name: string; image?: string | null | undefined; } | null'.
  Type 'undefined' is not assignable to type '{ id: string; createdAt: Date; updatedAt: Date; email: string; emailVerified: boolean; name: string; image?: string | null | undefined; } | null'. 
[36m		event.locals.session = session;
		[35mevent.locals.user[36m = session?.user;
	} catch (error) {[39m

c:\Users\toshimi.sato\program\sazanami\[32msrc\routes\api\notes\[id]\status\+server.ts[39m:57:14
[31mError[39m: Property 'rowCount' does not exist on type 'ResultSet'. 
[36m
		if (result.[35mrowCount[36m > 0) {
			// „Çø„Ç§„É†„É©„Ç§„É≥„Ç§„Éô„É≥„Éà„ÇíË®òÈå≤[39m

c:\Users\toshimi.sato\program\sazanami\[32msrc\routes\api\notes\import\+server.ts[39m:34:38
[31mError[39m: Argument of type '{ userId: string; title: string; content: string; }' is not assignable to parameter of type 'Omit<Note, "id" | "createdAt" | "updatedAt" | "slug">'.
  Type '{ userId: string; title: string; content: string; }' is missing the following properties from type 'Omit<Note, "id" | "createdAt" | "updatedAt" | "slug">': isPublic, isPinned, status, tags 
[36m
				const newNote = await createNote([35m{
					userId,
					title,
					content
				}[36m);[39m

c:\Users\toshimi.sato\program\sazanami\[32msrc\routes\settings\account\+page.server.ts[39m:53:15
[31mError[39m: 'e.body' is possibly 'undefined'. 
[36m				return fail(e.statusCode, {
					message: [35me.body[36m.message
				});[39m

c:\Users\toshimi.sato\program\sazanami\[32msrc\lib\components\TiptapEditor.svelte[39m:15:13
[33mWarn[39m: Component has unused export property 'placeholder'. If it is for external reference only, please consider using `export const placeholder`
https://svelte.dev/e/export_let_unused (svelte)
[36m	export let editable = true;
	export let [35mplaceholder[36m = 'Write something...';[39m

c:\Users\toshimi.sato\program\sazanami\[32msrc\lib\components\TiptapEditor.svelte[39m:8:9
[31mError[39m: Module '"c:/Users/toshimi.sato/program/sazanami/node_modules/@tiptap/extension-table/dist/index"' has no default export. Did you mean to use 'import { Table } from "c:/Users/toshimi.sato/program/sazanami/node_modules/@tiptap/extension-table/dist/index"' instead? (ts)
[36m	import Image from '@tiptap/extension-image';
	import [35mTable[36m from '@tiptap/extension-table';
	import TableRow from '@tiptap/extension-table-row';[39m

c:\Users\toshimi.sato\program\sazanami\[32msrc\lib\components\TiptapEditor.svelte[39m:46:37
[31mError[39m: Property 'markdown' does not exist on type 'Storage'. (ts)
[36m			onUpdate: ({ editor }) => {
				const markdown = editor.storage.[35mmarkdown[36m.getMarkdown();
				dispatch('change', { markdown });[39m

c:\Users\toshimi.sato\program\sazanami\[32msrc\routes\home\+page.svelte[39m:3:29
[31mError[39m: Cannot find module '$lib/components/MilkdownEditor.svelte' or its corresponding type declarations. (ts)
[36m	import type { PageData } from './$types';
	import MilkdownEditor from [35m'$lib/components/MilkdownEditor.svelte'[36m;
	import { invalidateAll } from '$app/navigation';[39m

c:\Users\toshimi.sato\program\sazanami\[32msrc\routes\home\box\+page.svelte[39m:96:11
[31mError[39m: Argument of type '(event: CustomEvent<string>) => Promise<void>' is not assignable to parameter of type '(e: CustomEvent<{ title: string; content: string; }>) => void'.
  Types of parameters 'event' and 'e' are incompatible.
    Type 'CustomEvent<{ title: string; content: string; }>' is not assignable to type 'CustomEvent<string>'.
      Type '{ title: string; content: string; }' is not assignable to type 'string'. (ts)
[36m	note={editingNote}
	on:save={[35mhandleSaveEdit[36m}
	on:cancel={handleCancelEdit}[39m

c:\Users\toshimi.sato\program\sazanami\[32msrc\routes\login\+page.svelte[39m:44:22
[31mError[39m: Property 'twoFactorRedirect' does not exist on type '{ redirect: boolean; token: string; url: string | undefined; user: { id: string; email: string; name: string; image: string | null | undefined; emailVerified: boolean; createdAt: Date; updatedAt: Date; }; }'. (ts)
[36m					error = apiError.message || '„É≠„Ç∞„Ç§„É≥„Å´Â§±Êïó„Åó„Åæ„Åó„Åü„ÄÇ';
				} else if (data?.[35mtwoFactorRedirect[36m) {
					console.log('2FA required, redirecting to two-factor page');[39m

c:\Users\toshimi.sato\program\sazanami\[32msrc\routes\login\+page.svelte[39m:147:21
[31mError[39m: Property 'twoFactorRedirect' does not exist on type 'NonNullable<{ redirect: boolean; token: string; url: undefined; user: { id: string; email: string; name: string; image: string | null | undefined; emailVerified: boolean; createdAt: Date; updatedAt: Date; }; } | { ...; }>'.
  Property 'twoFactorRedirect' does not exist on type '{ redirect: boolean; token: string; url: undefined; user: { id: string; email: string; name: string; image: string | null | undefined; emailVerified: boolean; createdAt: Date; updatedAt: Date; }; }'. (ts)
[36m				error = signInError.message || '„É≠„Ç∞„Ç§„É≥Âá∫Êù•„Åæ„Åõ„Çì„Åß„Åó„Åü„ÄÇ';
			} else if (data?.[35mtwoFactorRedirect[36m) {
				await goto('/login/two-factor' + (queryParams.toString() ? '?' + queryParams.toString() : ''));[39m

c:\Users\toshimi.sato\program\sazanami\[32msrc\routes\login\two-factor\+page.svelte[39m:105:7
[33mWarn[39m: Avoid using autofocus
https://svelte.dev/e/a11y_autofocus (svelte)
[36m						maxlength={mode === 'totp' ? 6 : undefined}
						[35mautofocus[36m
						autocomplete="one-time-code"[39m

c:\Users\toshimi.sato\program\sazanami\[32msrc\routes\settings\account\+page.svelte[39m:154:5
[31mError[39m: Type 'string | undefined' is not assignable to type 'string | null'.
  Type 'undefined' is not assignable to type 'string | null'. (ts)
[36m			} else if (res.error) {
				[35mtwoFactorError[36m = res.error.message;
			}[39m

c:\Users\toshimi.sato\program\sazanami\[32mtests\integration\attachments-api.test.ts[39m:82:65
[31mError[39m: Argument of type '{ user: User; session: Session; }' is not assignable to parameter of type '{ session: { id: string; createdAt: Date; updatedAt: Date; userId: string; expiresAt: Date; token: string; ipAddress?: string | null | undefined; userAgent?: string | null | undefined; }; user: { ...; } & { ...; }; }'.
  Types of property 'user' are incompatible.
    Type '{ id: string; createdAt: Date; updatedAt: Date; email: string; emailVerified: boolean; name: string; image?: string | null | undefined; }' is not assignable to type '{ id: string; createdAt: Date; updatedAt: Date; email: string; emailVerified: boolean; name: string; image?: string | null | undefined; } & { id: string; createdAt: Date; updatedAt: Date; ... 4 more ...; twoFactorEnabled: boolean | ... 1 more ... | undefined; }'.
      Property 'twoFactorEnabled' is missing in type '{ id: string; createdAt: Date; updatedAt: Date; email: string; emailVerified: boolean; name: string; image?: string | null | undefined; }' but required in type '{ id: string; createdAt: Date; updatedAt: Date; email: string; emailVerified: boolean; name: string; image?: string | null | undefined; twoFactorEnabled: boolean | null | undefined; }'. 
[36m
		vi.spyOn(authModule.auth.api, 'getSession').mockResolvedValue([35mmockSession[36m);[39m

c:\Users\toshimi.sato\program\sazanami\[32mtests\integration\attachments-api.test.ts[39m:85:31
[31mError[39m: Argument of type 'RequestEvent<{ id?: string | undefined; }, "/" | "/api" | "/api/attachments" | "/api/notes" | "/api/notes/import" | "/api/notes/resolve-link" | "/api/notes/[id]" | "/api/notes/[id]/links" | ... 15 more ... | null>' is not assignable to parameter of type 'RequestEvent<RouteParams, "/api/attachments">'.
  Type '"/" | "/api" | "/api/attachments" | "/api/notes" | "/api/notes/import" | "/api/notes/resolve-link" | "/api/notes/[id]" | "/api/notes/[id]/links" | "/api/notes/[id]/pin" | ... 14 more ... | null' is not assignable to type '"/api/attachments"'.
    Type 'null' is not assignable to type '"/api/attachments"'. 
[36m		// 4. Call the endpoint handler
		const response = await POST([35mevent[36m);
		const body = await response.json();[39m

c:\Users\toshimi.sato\program\sazanami\[32mtests\integration\attachments-api.test.ts[39m:119:31
[31mError[39m: Argument of type 'RequestEvent<{ id?: string | undefined; }, "/" | "/api" | "/api/attachments" | "/api/notes" | "/api/notes/import" | "/api/notes/resolve-link" | "/api/notes/[id]" | "/api/notes/[id]/links" | ... 15 more ... | null>' is not assignable to parameter of type 'RequestEvent<RouteParams, "/api/attachments">'.
  Type '"/" | "/api" | "/api/attachments" | "/api/notes" | "/api/notes/import" | "/api/notes/resolve-link" | "/api/notes/[id]" | "/api/notes/[id]/links" | "/api/notes/[id]/pin" | ... 14 more ... | null' is not assignable to type '"/api/attachments"'.
    Type 'null' is not assignable to type '"/api/attachments"'. 
[36m
		const response = await POST([35mevent[36m);
		expect(response.status).toBe(401);[39m

c:\Users\toshimi.sato\program\sazanami\[32mtests\integration\import-api.test.ts[39m:70:65
[31mError[39m: Argument of type '{ user: User; session: Session; }' is not assignable to parameter of type '{ session: { id: string; createdAt: Date; updatedAt: Date; userId: string; expiresAt: Date; token: string; ipAddress?: string | null | undefined; userAgent?: string | null | undefined; }; user: { ...; } & { ...; }; }'.
  Types of property 'user' are incompatible.
    Type '{ id: string; createdAt: Date; updatedAt: Date; email: string; emailVerified: boolean; name: string; image?: string | null | undefined; }' is not assignable to type '{ id: string; createdAt: Date; updatedAt: Date; email: string; emailVerified: boolean; name: string; image?: string | null | undefined; } & { id: string; createdAt: Date; updatedAt: Date; ... 4 more ...; twoFactorEnabled: boolean | ... 1 more ... | undefined; }'.
      Property 'twoFactorEnabled' is missing in type '{ id: string; createdAt: Date; updatedAt: Date; email: string; emailVerified: boolean; name: string; image?: string | null | undefined; }' but required in type '{ id: string; createdAt: Date; updatedAt: Date; email: string; emailVerified: boolean; name: string; image?: string | null | undefined; twoFactorEnabled: boolean | null | undefined; }'. 
[36m
		vi.spyOn(authModule.auth.api, 'getSession').mockResolvedValue([35mmockSession[36m);[39m

c:\Users\toshimi.sato\program\sazanami\[32mtests\integration\import-api.test.ts[39m:73:31
[31mError[39m: Argument of type 'RequestEvent<{ id?: string | undefined; }, "/" | "/api" | "/api/attachments" | "/api/notes" | "/api/notes/import" | "/api/notes/resolve-link" | "/api/notes/[id]" | "/api/notes/[id]/links" | ... 15 more ... | null>' is not assignable to parameter of type 'RequestEvent<RouteParams, "/api/notes/import">'.
  Type '"/" | "/api" | "/api/attachments" | "/api/notes" | "/api/notes/import" | "/api/notes/resolve-link" | "/api/notes/[id]" | "/api/notes/[id]/links" | "/api/notes/[id]/pin" | ... 14 more ... | null' is not assignable to type '"/api/notes/import"'.
    Type 'null' is not assignable to type '"/api/notes/import"'. 
[36m		// 4. Call the endpoint handler
		const response = await POST([35mevent[36m);
		const body = await response.json();[39m

c:\Users\toshimi.sato\program\sazanami\[32mtests\integration\main-scenarios.test.ts[39m:68:9
[31mError[39m: Conversion of type '{ request: Request; locals: App.Locals; params: Record<string, string>; url: URL; cookies: { get: Mock<Procedure>; set: Mock<Procedure>; delete: Mock<...>; serialize: Mock<...>; getAll: Mock<...>; }; ... 6 more ...; isSubRequest: false; }' to type 'RequestEvent<{ id?: string | undefined; }, "/" | "/api" | "/api/attachments" | "/api/notes" | "/api/notes/import" | "/api/notes/resolve-link" | "/api/notes/[id]" | "/api/notes/[id]/links" | ... 15 more ... | null>' may be a mistake because neither type sufficiently overlaps with the other. If this was intentional, convert the expression to 'unknown' first.
  Type '{ request: Request; locals: Locals; params: Record<string, string>; url: URL; cookies: { get: Mock<Procedure>; set: Mock<Procedure>; delete: Mock<...>; serialize: Mock<...>; getAll: Mock<...>; }; ... 6 more ...; isSubRequest: false; }' is missing the following properties from type 'RequestEvent<{ id?: string | undefined; }, "/" | "/api" | "/api/attachments" | "/api/notes" | "/api/notes/import" | "/api/notes/resolve-link" | "/api/notes/[id]" | "/api/notes/[id]/links" | ... 15 more ... | null>': tracing, isRemoteRequest 
[36m
	return [35m{
		request,
		locals,
		params,
		url: new URL(request.url),
		cookies: { get: vi.fn(), set: vi.fn(), delete: vi.fn(), serialize: vi.fn(), getAll: vi.fn() },
		fetch: vi.fn(),
		getClientAddress: () => '127.0.0.1',
		platform: { env: { DB: {} as any } },
		route: { id: null },
		setHeaders: vi.fn(),
		isDataRequest: false,
		isSubRequest: false
	} as RequestEvent[36m;
};[39m

c:\Users\toshimi.sato\program\sazanami\[32mtests\integration\main-scenarios.test.ts[39m:91:2
[31mError[39m: Type '{ request: Request; locals: Locals; params: Record<string, string>; url: URL; cookies: { get: Mock<Procedure>; set: Mock<Procedure>; delete: Mock<...>; serialize: Mock<...>; getAll: Mock<...>; }; ... 9 more ...; untrack: Mock<...>; }' is missing the following properties from type 'ServerLoadEvent<{ id?: string | undefined; }, Record<string, any>, "/" | "/api" | "/api/attachments" | "/api/notes" | "/api/notes/import" | "/api/notes/resolve-link" | "/api/notes/[id]" | ... 16 more ... | null>': tracing, isRemoteRequest 
[36m
	[35mreturn[36m {
		request,[39m

c:\Users\toshimi.sato\program\sazanami\[32mtests\integration\main-scenarios.test.ts[39m:125:32
[31mError[39m: Argument of type 'RequestEvent<{ id?: string | undefined; }, "/" | "/api" | "/api/attachments" | "/api/notes" | "/api/notes/import" | "/api/notes/resolve-link" | "/api/notes/[id]" | "/api/notes/[id]/links" | ... 15 more ... | null>' is not assignable to parameter of type 'RequestEvent<RouteParams, "/home/note/new">'.
  Type '"/" | "/api" | "/api/attachments" | "/api/notes" | "/api/notes/import" | "/api/notes/resolve-link" | "/api/notes/[id]" | "/api/notes/[id]/links" | "/api/notes/[id]/pin" | ... 14 more ... | null' is not assignable to type '"/home/note/new"'.
    Type 'null' is not assignable to type '"/home/note/new"'. 
[36m
		await expect(actions.default([35mevent[36m)).rejects.toThrow();[39m

c:\Users\toshimi.sato\program\sazanami\[32mtests\integration\main-scenarios.test.ts[39m:147:65
[31mError[39m: Argument of type '{ user: User; session: Session; }' is not assignable to parameter of type '{ session: { id: string; createdAt: Date; updatedAt: Date; userId: string; expiresAt: Date; token: string; ipAddress?: string | null | undefined; userAgent?: string | null | undefined; }; user: { ...; } & { ...; }; }'.
  Types of property 'user' are incompatible.
    Type '{ id: string; createdAt: Date; updatedAt: Date; email: string; emailVerified: boolean; name: string; image?: string | null | undefined; }' is not assignable to type '{ id: string; createdAt: Date; updatedAt: Date; email: string; emailVerified: boolean; name: string; image?: string | null | undefined; } & { id: string; createdAt: Date; updatedAt: Date; ... 4 more ...; twoFactorEnabled: boolean | ... 1 more ... | undefined; }'.
      Property 'twoFactorEnabled' is missing in type '{ id: string; createdAt: Date; updatedAt: Date; email: string; emailVerified: boolean; name: string; image?: string | null | undefined; }' but required in type '{ id: string; createdAt: Date; updatedAt: Date; email: string; emailVerified: boolean; name: string; image?: string | null | undefined; twoFactorEnabled: boolean | null | undefined; }'. 
[36m
		vi.spyOn(authModule.auth.api, 'getSession').mockResolvedValue([35mmockSession[36m);
		const pageData = await load(event);[39m

c:\Users\toshimi.sato\program\sazanami\[32mtests\integration\main-scenarios.test.ts[39m:148:31
[31mError[39m: Argument of type 'ServerLoadEvent<{ id?: string | undefined; }, Record<string, any>, "/" | "/api" | "/api/attachments" | "/api/notes" | "/api/notes/import" | "/api/notes/resolve-link" | "/api/notes/[id]" | ... 16 more ... | null>' is not assignable to parameter of type 'ServerLoadEvent<RouteParams, { session: { id: string; createdAt: Date; updatedAt: Date; userId: string; expiresAt: Date; token: string; ipAddress?: string | null | undefined; userAgent?: string | ... 1 more ... | undefined; } | null; user: { ...; } | null; }, "/home/box">'.
  Type 'Record<string, any>' is missing the following properties from type '{ session: { id: string; createdAt: Date; updatedAt: Date; userId: string; expiresAt: Date; token: string; ipAddress?: string | null | undefined; userAgent?: string | null | undefined; } | null; user: { ...; } | null; }': session, user 
[36m		vi.spyOn(authModule.auth.api, 'getSession').mockResolvedValue(mockSession);
		const pageData = await load([35mevent[36m);[39m

c:\Users\toshimi.sato\program\sazanami\[32mtests\integration\main-scenarios.test.ts[39m:150:19
[31mError[39m: Property 'notes' does not exist on type 'void | (Omit<PageData, RequiredKeys<T>> & Partial<Pick<PageData, never>> & Record<string, any>)'.
  Property 'notes' does not exist on type 'void'. 
[36m
		expect(pageData.[35mnotes[36m).toBeDefined();
		expect(pageData.notes.length).toBeGreaterThan(0);[39m

c:\Users\toshimi.sato\program\sazanami\[32mtests\integration\main-scenarios.test.ts[39m:151:19
[31mError[39m: Property 'notes' does not exist on type 'void | (Omit<PageData, RequiredKeys<T>> & Partial<Pick<PageData, never>> & Record<string, any>)'.
  Property 'notes' does not exist on type 'void'. 
[36m		expect(pageData.notes).toBeDefined();
		expect(pageData.[35mnotes[36m.length).toBeGreaterThan(0);
		const foundNote = pageData.notes.find((n) => n.id === createdNoteId);[39m

c:\Users\toshimi.sato\program\sazanami\[32mtests\integration\main-scenarios.test.ts[39m:152:30
[31mError[39m: Property 'notes' does not exist on type 'void | (Omit<PageData, RequiredKeys<T>> & Partial<Pick<PageData, never>> & Record<string, any>)'.
  Property 'notes' does not exist on type 'void'. 
[36m		expect(pageData.notes.length).toBeGreaterThan(0);
		const foundNote = pageData.[35mnotes[36m.find((n) => n.id === createdNoteId);
		expect(foundNote).toBeDefined();[39m

c:\Users\toshimi.sato\program\sazanami\[32mtests\integration\main-scenarios.test.ts[39m:152:42
[31mError[39m: Parameter 'n' implicitly has an 'any' type. 
[36m		expect(pageData.notes.length).toBeGreaterThan(0);
		const foundNote = pageData.notes.find(([35mn[36m) => n.id === createdNoteId);
		expect(foundNote).toBeDefined();[39m

c:\Users\toshimi.sato\program\sazanami\[32mtests\integration\main-scenarios.test.ts[39m:169:32
[31mError[39m: Argument of type 'RequestEvent<{ id?: string | undefined; }, "/" | "/api" | "/api/attachments" | "/api/notes" | "/api/notes/import" | "/api/notes/resolve-link" | "/api/notes/[id]" | "/api/notes/[id]/links" | ... 15 more ... | null>' is not assignable to parameter of type 'RequestEvent<RouteParams, "/home/note/[id]">'.
  Type '{ id?: string | undefined; }' is not assignable to type 'RouteParams'.
    Types of property 'id' are incompatible.
      Type 'string | undefined' is not assignable to type 'string'.
        Type 'undefined' is not assignable to type 'string'. 
[36m
		await expect(actions.default([35mevent[36m)).rejects.toThrow();[39m

c:\Users\toshimi.sato\program\sazanami\[32mtests\integration\main-scenarios.test.ts[39m:206:65
[31mError[39m: Argument of type '{ user: User; session: Session; }' is not assignable to parameter of type '{ session: { id: string; createdAt: Date; updatedAt: Date; userId: string; expiresAt: Date; token: string; ipAddress?: string | null | undefined; userAgent?: string | null | undefined; }; user: { ...; } & { ...; }; }'.
  Types of property 'user' are incompatible.
    Type '{ id: string; createdAt: Date; updatedAt: Date; email: string; emailVerified: boolean; name: string; image?: string | null | undefined; }' is not assignable to type '{ id: string; createdAt: Date; updatedAt: Date; email: string; emailVerified: boolean; name: string; image?: string | null | undefined; } & { id: string; createdAt: Date; updatedAt: Date; ... 4 more ...; twoFactorEnabled: boolean | ... 1 more ... | undefined; }'.
      Property 'twoFactorEnabled' is missing in type '{ id: string; createdAt: Date; updatedAt: Date; email: string; emailVerified: boolean; name: string; image?: string | null | undefined; }' but required in type '{ id: string; createdAt: Date; updatedAt: Date; email: string; emailVerified: boolean; name: string; image?: string | null | undefined; twoFactorEnabled: boolean | null | undefined; }'. 
[36m		});
		vi.spyOn(authModule.auth.api, 'getSession').mockResolvedValue([35mmockSession[36m);
		const pageData = await load(listEvent);[39m

c:\Users\toshimi.sato\program\sazanami\[32mtests\integration\main-scenarios.test.ts[39m:207:31
[31mError[39m: Argument of type 'ServerLoadEvent<{ id?: string | undefined; }, Record<string, any>, "/" | "/api" | "/api/attachments" | "/api/notes" | "/api/notes/import" | "/api/notes/resolve-link" | "/api/notes/[id]" | ... 16 more ... | null>' is not assignable to parameter of type 'ServerLoadEvent<RouteParams, { session: { id: string; createdAt: Date; updatedAt: Date; userId: string; expiresAt: Date; token: string; ipAddress?: string | null | undefined; userAgent?: string | ... 1 more ... | undefined; } | null; user: { ...; } | null; }, "/home/box">'.
  Type 'Record<string, any>' is missing the following properties from type '{ session: { id: string; createdAt: Date; updatedAt: Date; userId: string; expiresAt: Date; token: string; ipAddress?: string | null | undefined; userAgent?: string | null | undefined; } | null; user: { ...; } | null; }': session, user 
[36m		vi.spyOn(authModule.auth.api, 'getSession').mockResolvedValue(mockSession);
		const pageData = await load([35mlistEvent[36m);
		const foundNote = pageData.notes.find((n) => n.id === createdNoteId);[39m

c:\Users\toshimi.sato\program\sazanami\[32mtests\integration\main-scenarios.test.ts[39m:208:30
[31mError[39m: Property 'notes' does not exist on type 'void | (Omit<PageData, RequiredKeys<T>> & Partial<Pick<PageData, never>> & Record<string, any>)'.
  Property 'notes' does not exist on type 'void'. 
[36m		const pageData = await load(listEvent);
		const foundNote = pageData.[35mnotes[36m.find((n) => n.id === createdNoteId);
		expect(foundNote).toBeUndefined();[39m

c:\Users\toshimi.sato\program\sazanami\[32mtests\integration\main-scenarios.test.ts[39m:208:42
[31mError[39m: Parameter 'n' implicitly has an 'any' type. 
[36m		const pageData = await load(listEvent);
		const foundNote = pageData.notes.find(([35mn[36m) => n.id === createdNoteId);
		expect(foundNote).toBeUndefined();[39m

c:\Users\toshimi.sato\program\sazanami\[32mtests\integration\main-scenarios.test.ts[39m:225:45
[31mError[39m: Argument of type 'RequestEvent<{ id?: string | undefined; }, "/" | "/api" | "/api/attachments" | "/api/notes" | "/api/notes/import" | "/api/notes/resolve-link" | "/api/notes/[id]" | "/api/notes/[id]/links" | ... 15 more ... | null>' is not assignable to parameter of type 'RequestEvent<RouteParams, "/home/note/new">'.
  Type '"/" | "/api" | "/api/attachments" | "/api/notes" | "/api/notes/import" | "/api/notes/resolve-link" | "/api/notes/[id]" | "/api/notes/[id]/links" | "/api/notes/[id]/pin" | ... 14 more ... | null' is not assignable to type '"/home/note/new"'.
    Type 'null' is not assignable to type '"/home/note/new"'. 
[36m		);
		await expect(createAction.actions.default([35mcreateEvent[36m)).rejects.toThrow();[39m

c:\Users\toshimi.sato\program\sazanami\[32mtests\integration\main-scenarios.test.ts[39m:250:31
[31mError[39m: Argument of type 'ServerLoadEvent<{ id?: string | undefined; }, Record<string, any>, "/" | "/api" | "/api/attachments" | "/api/notes" | "/api/notes/import" | "/api/notes/resolve-link" | "/api/notes/[id]" | ... 16 more ... | null>' is not assignable to parameter of type 'ServerLoadEvent<RouteParams, { session: { id: string; createdAt: Date; updatedAt: Date; userId: string; expiresAt: Date; token: string; ipAddress?: string | null | undefined; userAgent?: string | ... 1 more ... | undefined; } | null; user: { ...; } | null; }, "/home/note/[id]">'.
  Type '{ id?: string | undefined; }' is not assignable to type 'RouteParams'.
    Types of property 'id' are incompatible.
      Type 'string | undefined' is not assignable to type 'string'.
        Type 'undefined' is not assignable to type 'string'. 
[36m
		const pageData = await load([35mloadEvent[36m);[39m

c:\Users\toshimi.sato\program\sazanami\[32mtests\integration\main-scenarios.test.ts[39m:253:19
[31mError[39m: Property 'note' does not exist on type 'void | (Omit<PageData, RequiredKeys<T>> & Partial<Pick<PageData, never>> & Record<string, any>)'.
  Property 'note' does not exist on type 'void'. 
[36m		// 3. Assert correct data was loaded
		expect(pageData.[35mnote[36m).toBeDefined();
		expect(pageData.note.title).toBe(japaneseNoteData.title);[39m

c:\Users\toshimi.sato\program\sazanami\[32mtests\integration\main-scenarios.test.ts[39m:254:19
[31mError[39m: Property 'note' does not exist on type 'void | (Omit<PageData, RequiredKeys<T>> & Partial<Pick<PageData, never>> & Record<string, any>)'.
  Property 'note' does not exist on type 'void'. 
[36m		expect(pageData.note).toBeDefined();
		expect(pageData.[35mnote[36m.title).toBe(japaneseNoteData.title);
		expect(pageData.note.content).toBe(japaneseNoteData.content);[39m

c:\Users\toshimi.sato\program\sazanami\[32mtests\integration\main-scenarios.test.ts[39m:255:19
[31mError[39m: Property 'note' does not exist on type 'void | (Omit<PageData, RequiredKeys<T>> & Partial<Pick<PageData, never>> & Record<string, any>)'.
  Property 'note' does not exist on type 'void'. 
[36m		expect(pageData.note.title).toBe(japaneseNoteData.title);
		expect(pageData.[35mnote[36m.content).toBe(japaneseNoteData.content);[39m

c:\Users\toshimi.sato\program\sazanami\[32mtests\integration\main-scenarios.test.ts[39m:257:66
[31mError[39m: Property 'note' does not exist on type 'void | (Omit<PageData, RequiredKeys<T>> & Partial<Pick<PageData, never>> & Record<string, any>)'.
  Property 'note' does not exist on type 'void'. 
[36m
		await db.delete(notesSchema).where(eq(notesSchema.id, pageData.[35mnote[36m.id));
	});[39m

c:\Users\toshimi.sato\program\sazanami\[32mtests\integration\main-scenarios.test.ts[39m:283:65
[31mError[39m: Argument of type '{ user: User; session: Session; }' is not assignable to parameter of type '{ session: { id: string; createdAt: Date; updatedAt: Date; userId: string; expiresAt: Date; token: string; ipAddress?: string | null | undefined; userAgent?: string | null | undefined; }; user: { ...; } & { ...; }; }'.
  Types of property 'user' are incompatible.
    Type '{ id: string; createdAt: Date; updatedAt: Date; email: string; emailVerified: boolean; name: string; image?: string | null | undefined; }' is not assignable to type '{ id: string; createdAt: Date; updatedAt: Date; email: string; emailVerified: boolean; name: string; image?: string | null | undefined; } & { id: string; createdAt: Date; updatedAt: Date; ... 4 more ...; twoFactorEnabled: boolean | ... 1 more ... | undefined; }'.
      Property 'twoFactorEnabled' is missing in type '{ id: string; createdAt: Date; updatedAt: Date; email: string; emailVerified: boolean; name: string; image?: string | null | undefined; }' but required in type '{ id: string; createdAt: Date; updatedAt: Date; email: string; emailVerified: boolean; name: string; image?: string | null | undefined; twoFactorEnabled: boolean | null | undefined; }'. 
[36m		});
		vi.spyOn(authModule.auth.api, 'getSession').mockResolvedValue([35mmockSession[36m);[39m

c:\Users\toshimi.sato\program\sazanami\[32mtests\integration\main-scenarios.test.ts[39m:289:19
[31mError[39m: Property 'notes' does not exist on type 'void | Record<string, any>'.
  Property 'notes' does not exist on type 'void'. 
[36m		// 5. Assert the results
		expect(pageData.[35mnotes[36m).toBeDefined();
		expect(pageData.notes.length).toBeGreaterThan(0);[39m

c:\Users\toshimi.sato\program\sazanami\[32mtests\integration\main-scenarios.test.ts[39m:290:19
[31mError[39m: Property 'notes' does not exist on type 'void | Record<string, any>'.
  Property 'notes' does not exist on type 'void'. 
[36m		expect(pageData.notes).toBeDefined();
		expect(pageData.[35mnotes[36m.length).toBeGreaterThan(0);
		const foundNote = pageData.notes.find((n) => n.title === inboxNoteTitle);[39m

c:\Users\toshimi.sato\program\sazanami\[32mtests\integration\main-scenarios.test.ts[39m:291:30
[31mError[39m: Property 'notes' does not exist on type 'void | Record<string, any>'.
  Property 'notes' does not exist on type 'void'. 
[36m		expect(pageData.notes.length).toBeGreaterThan(0);
		const foundNote = pageData.[35mnotes[36m.find((n) => n.title === inboxNoteTitle);
		expect(foundNote).toBeDefined();[39m

c:\Users\toshimi.sato\program\sazanami\[32mtests\integration\main-scenarios.test.ts[39m:291:42
[31mError[39m: Parameter 'n' implicitly has an 'any' type. 
[36m		expect(pageData.notes.length).toBeGreaterThan(0);
		const foundNote = pageData.notes.find(([35mn[36m) => n.title === inboxNoteTitle);
		expect(foundNote).toBeDefined();[39m

c:\Users\toshimi.sato\program\sazanami\[32mtests\integration\main-scenarios.test.ts[39m:339:65
[31mError[39m: Argument of type '{ user: User; session: Session; }' is not assignable to parameter of type '{ session: { id: string; createdAt: Date; updatedAt: Date; userId: string; expiresAt: Date; token: string; ipAddress?: string | null | undefined; userAgent?: string | null | undefined; }; user: { ...; } & { ...; }; }'.
  Types of property 'user' are incompatible.
    Type '{ id: string; createdAt: Date; updatedAt: Date; email: string; emailVerified: boolean; name: string; image?: string | null | undefined; }' is not assignable to type '{ id: string; createdAt: Date; updatedAt: Date; email: string; emailVerified: boolean; name: string; image?: string | null | undefined; } & { id: string; createdAt: Date; updatedAt: Date; ... 4 more ...; twoFactorEnabled: boolean | ... 1 more ... | undefined; }'.
      Property 'twoFactorEnabled' is missing in type '{ id: string; createdAt: Date; updatedAt: Date; email: string; emailVerified: boolean; name: string; image?: string | null | undefined; }' but required in type '{ id: string; createdAt: Date; updatedAt: Date; email: string; emailVerified: boolean; name: string; image?: string | null | undefined; twoFactorEnabled: boolean | null | undefined; }'. 
[36m		} as unknown as RequestEvent;
		vi.spyOn(authModule.auth.api, 'getSession').mockResolvedValue([35mmockSession[36m);[39m

c:\Users\toshimi.sato\program\sazanami\[32mtests\integration\main-scenarios.test.ts[39m:358:65
[31mError[39m: Argument of type '{ user: User; session: Session; }' is not assignable to parameter of type '{ session: { id: string; createdAt: Date; updatedAt: Date; userId: string; expiresAt: Date; token: string; ipAddress?: string | null | undefined; userAgent?: string | null | undefined; }; user: { ...; } & { ...; }; }'.
  Types of property 'user' are incompatible.
    Type '{ id: string; createdAt: Date; updatedAt: Date; email: string; emailVerified: boolean; name: string; image?: string | null | undefined; }' is not assignable to type '{ id: string; createdAt: Date; updatedAt: Date; email: string; emailVerified: boolean; name: string; image?: string | null | undefined; } & { id: string; createdAt: Date; updatedAt: Date; ... 4 more ...; twoFactorEnabled: boolean | ... 1 more ... | undefined; }'.
      Property 'twoFactorEnabled' is missing in type '{ id: string; createdAt: Date; updatedAt: Date; email: string; emailVerified: boolean; name: string; image?: string | null | undefined; }' but required in type '{ id: string; createdAt: Date; updatedAt: Date; email: string; emailVerified: boolean; name: string; image?: string | null | undefined; twoFactorEnabled: boolean | null | undefined; }'. 
[36m		} as unknown as RequestEvent;
		vi.spyOn(authModule.auth.api, 'getSession').mockResolvedValue([35mmockSession[36m);[39m

c:\Users\toshimi.sato\program\sazanami\[32mtests\integration\note-links-db.test.ts[39m:28:33
[31mError[39m: Argument of type '{ userId: string; title: string; content: string; }' is not assignable to parameter of type 'Omit<Note, "id" | "createdAt" | "updatedAt" | "slug">'.
  Type '{ userId: string; title: string; content: string; }' is missing the following properties from type 'Omit<Note, "id" | "createdAt" | "updatedAt" | "slug">': isPublic, isPinned, status, tags 
[36m	// Pre-create target notes
	const noteA = await createNote([35m{
		userId: testUser.id,
		title: 'Target A',
		content: '...'
	}[36m);
	const noteB = await createNote({[39m

c:\Users\toshimi.sato\program\sazanami\[32mtests\integration\note-links-db.test.ts[39m:33:33
[31mError[39m: Argument of type '{ userId: string; title: string; content: string; }' is not assignable to parameter of type 'Omit<Note, "id" | "createdAt" | "updatedAt" | "slug">'.
  Type '{ userId: string; title: string; content: string; }' is missing the following properties from type 'Omit<Note, "id" | "createdAt" | "updatedAt" | "slug">': isPublic, isPinned, status, tags 
[36m	});
	const noteB = await createNote([35m{
		userId: testUser.id,
		title: 'Target B',
		content: '...'
	}[36m);
	noteIds['Target A'] = noteA.id;[39m

c:\Users\toshimi.sato\program\sazanami\[32mtests\integration\note-links-db.test.ts[39m:50:39
[31mError[39m: Argument of type '{ userId: string; title: string; content: string; }' is not assignable to parameter of type 'Omit<Note, "id" | "createdAt" | "updatedAt" | "slug">'.
  Type '{ userId: string; title: string; content: string; }' is missing the following properties from type 'Omit<Note, "id" | "createdAt" | "updatedAt" | "slug">': isPublic, isPinned, status, tags 
[36m	it('should create a link when a new note with a wiki link is created', async () => {
		const sourceNote = await createNote([35m{
			userId: testUser.id,
			title: 'Source Note 1',
			content: 'This links to [[Target A]].'
		}[36m);
		await updateNoteLinks(sourceNote.id, sourceNote.content || '', testUser.id);[39m

c:\Users\toshimi.sato\program\sazanami\[32mtests\integration\note-links-db.test.ts[39m:68:39
[31mError[39m: Argument of type '{ userId: string; title: string; content: string; }' is not assignable to parameter of type 'Omit<Note, "id" | "createdAt" | "updatedAt" | "slug">'.
  Type '{ userId: string; title: string; content: string; }' is missing the following properties from type 'Omit<Note, "id" | "createdAt" | "updatedAt" | "slug">': isPublic, isPinned, status, tags 
[36m		// First, create a note with a link to A
		const sourceNote = await createNote([35m{
			userId: testUser.id,
			title: 'Source Note 2',
			content: 'Initial link to [[Target A]].'
		}[36m);
		await updateNoteLinks(sourceNote.id, sourceNote.content || '', testUser.id);[39m

c:\Users\toshimi.sato\program\sazanami\[32mtests\integration\note-links-db.test.ts[39m:91:39
[31mError[39m: Argument of type '{ userId: string; title: string; content: string; }' is not assignable to parameter of type 'Omit<Note, "id" | "createdAt" | "updatedAt" | "slug">'.
  Type '{ userId: string; title: string; content: string; }' is missing the following properties from type 'Omit<Note, "id" | "createdAt" | "updatedAt" | "slug">': isPublic, isPinned, status, tags 
[36m		// First, create a note with a link
		const sourceNote = await createNote([35m{
			userId: testUser.id,
			title: 'Source Note 3',
			content: 'This will have its link removed. [[Target A]]'
		}[36m);
		await updateNoteLinks(sourceNote.id, sourceNote.content || '', testUser.id);[39m

c:\Users\toshimi.sato\program\sazanami\[32mtests\integration\notes-api.test.ts[39m:47:9
[31mError[39m: Conversion of type '{ request: Request; url: URL; params: Record<string, string>; cookies: { get: Mock<Procedure>; set: Mock<Procedure>; delete: Mock<Procedure>; serialize: Mock<...>; getAll: Mock<...>; }; ... 7 more ...; isSubRequest: false; }' to type 'RequestEvent<{ id?: string | undefined; }, "/" | "/api" | "/api/attachments" | "/api/notes" | "/api/notes/import" | "/api/notes/resolve-link" | "/api/notes/[id]" | "/api/notes/[id]/links" | ... 15 more ... | null>' may be a mistake because neither type sufficiently overlaps with the other. If this was intentional, convert the expression to 'unknown' first.
  Type '{ request: Request; url: URL; params: Record<string, string>; cookies: { get: Mock<Procedure>; set: Mock<Procedure>; delete: Mock<Procedure>; serialize: Mock<...>; getAll: Mock<...>; }; ... 7 more ...; isSubRequest: false; }' is missing the following properties from type 'RequestEvent<{ id?: string | undefined; }, "/" | "/api" | "/api/attachments" | "/api/notes" | "/api/notes/import" | "/api/notes/resolve-link" | "/api/notes/[id]" | "/api/notes/[id]/links" | ... 15 more ... | null>': tracing, isRemoteRequest 
[36m
	return [35m{
		request: request,
		url: new URL(request.url),
		params: params || {},
		cookies: {
			get: vi.fn(),
			set: vi.fn(),
			delete: vi.fn(),
			serialize: vi.fn(),
			getAll: vi.fn()
		},
		fetch: vi.fn(),
		getClientAddress: vi.fn(() => '127.0.0.1'),
		locals: {
			user: session ? session.user : null,
			session: session ? session.session : null,
			auth: authModule.auth.api
		},
		platform: { env: { DB: {} as any } }, // DB „Éó„É≠„Éë„ÉÜ„Ç£„ÇíËøΩÂä†
		route: {
			id: '/api/notes'
		},
		setHeaders: vi.fn(),
		isDataRequest: false,
		isSubRequest: false
	} as RequestEvent[36m;
};[39m

c:\Users\toshimi.sato\program\sazanami\[32mtests\integration\notes-api.test.ts[39m:126:69
[31mError[39m: Argument of type '{ user: User; session: Session; }' is not assignable to parameter of type '{ session: { id: string; createdAt: Date; updatedAt: Date; userId: string; expiresAt: Date; token: string; ipAddress?: string | null | undefined; userAgent?: string | null | undefined; }; user: { ...; } & { ...; }; }'.
  Types of property 'user' are incompatible.
    Type '{ id: string; createdAt: Date; updatedAt: Date; email: string; emailVerified: boolean; name: string; image?: string | null | undefined; }' is not assignable to type '{ id: string; createdAt: Date; updatedAt: Date; email: string; emailVerified: boolean; name: string; image?: string | null | undefined; } & { id: string; createdAt: Date; updatedAt: Date; ... 4 more ...; twoFactorEnabled: boolean | ... 1 more ... | undefined; }'.
      Property 'twoFactorEnabled' is missing in type '{ id: string; createdAt: Date; updatedAt: Date; email: string; emailVerified: boolean; name: string; image?: string | null | undefined; }' but required in type '{ id: string; createdAt: Date; updatedAt: Date; email: string; emailVerified: boolean; name: string; image?: string | null | undefined; twoFactorEnabled: boolean | null | undefined; }'. 
[36m	it('should return 400 if invalid JSON format', async () => {
		vi.spyOn(authModule.auth.api, 'getSession').mockResolvedValueOnce([35mmockSession[36m);
		const request = new Request('http://localhost/api/notes', {[39m

c:\Users\toshimi.sato\program\sazanami\[32mtests\integration\notes-api.test.ts[39m:133:18
[31mError[39m: Conversion of type '{ request: Request; url: URL; params: {}; cookies: { get: Mock<Procedure>; set: Mock<Procedure>; delete: Mock<Procedure>; serialize: Mock<...>; getAll: Mock<...>; }; ... 7 more ...; isSubRequest: false; }' to type 'RequestEvent<{ id?: string | undefined; }, "/" | "/api" | "/api/attachments" | "/api/notes" | "/api/notes/import" | "/api/notes/resolve-link" | "/api/notes/[id]" | "/api/notes/[id]/links" | ... 15 more ... | null>' may be a mistake because neither type sufficiently overlaps with the other. If this was intentional, convert the expression to 'unknown' first.
  Type '{ request: Request; url: URL; params: {}; cookies: { get: Mock<Procedure>; set: Mock<Procedure>; delete: Mock<Procedure>; serialize: Mock<...>; getAll: Mock<...>; }; ... 7 more ...; isSubRequest: false; }' is missing the following properties from type 'RequestEvent<{ id?: string | undefined; }, "/" | "/api" | "/api/attachments" | "/api/notes" | "/api/notes/import" | "/api/notes/resolve-link" | "/api/notes/[id]" | "/api/notes/[id]/links" | ... 15 more ... | null>': tracing, isRemoteRequest 
[36m		// RequestEvent„ÅÆ„É¢„ÉÉ„ÇØ„ÇíÈÅ©Âàá„Å´‰ΩúÊàê
		const params = [35m{
			request,
			url: new URL(request.url),
			params: {},
			cookies: { get: vi.fn(), set: vi.fn(), delete: vi.fn(), serialize: vi.fn(), getAll: vi.fn() },
			fetch: vi.fn(),
			getClientAddress: vi.fn(() => '127.0.0.1'),
			locals: {
				user: mockSession.user,
				session: mockSession.session,
				auth: authModule.auth.api
			},
			platform: { env: { DB: {} as any } }, // DB „Éó„É≠„Éë„ÉÜ„Ç£„ÇíËøΩÂä†
			route: { id: '/api/notes' },
			setHeaders: vi.fn(),
			isDataRequest: false,
			isSubRequest: false
		} as RequestEvent[36m;
		const response = await createNote(params);[39m

c:\Users\toshimi.sato\program\sazanami\[32mtests\integration\notes-api.test.ts[39m:158:69
[31mError[39m: Argument of type '{ user: User; session: Session; }' is not assignable to parameter of type '{ session: { id: string; createdAt: Date; updatedAt: Date; userId: string; expiresAt: Date; token: string; ipAddress?: string | null | undefined; userAgent?: string | null | undefined; }; user: { ...; } & { ...; }; }'.
  Types of property 'user' are incompatible.
    Type '{ id: string; createdAt: Date; updatedAt: Date; email: string; emailVerified: boolean; name: string; image?: string | null | undefined; }' is not assignable to type '{ id: string; createdAt: Date; updatedAt: Date; email: string; emailVerified: boolean; name: string; image?: string | null | undefined; } & { id: string; createdAt: Date; updatedAt: Date; ... 4 more ...; twoFactorEnabled: boolean | ... 1 more ... | undefined; }'.
      Property 'twoFactorEnabled' is missing in type '{ id: string; createdAt: Date; updatedAt: Date; email: string; emailVerified: boolean; name: string; image?: string | null | undefined; }' but required in type '{ id: string; createdAt: Date; updatedAt: Date; email: string; emailVerified: boolean; name: string; image?: string | null | undefined; twoFactorEnabled: boolean | null | undefined; }'. 
[36m	it('should create a note and save the correct slug', async () => {
		vi.spyOn(authModule.auth.api, 'getSession').mockResolvedValueOnce([35mmockSession[36m);
		const noteTitle = 'My New Test Note';[39m

c:\Users\toshimi.sato\program\sazanami\[32mtests\integration\notes-api.test.ts[39m:183:69
[31mError[39m: Argument of type '{ user: User; session: Session; }' is not assignable to parameter of type '{ session: { id: string; createdAt: Date; updatedAt: Date; userId: string; expiresAt: Date; token: string; ipAddress?: string | null | undefined; userAgent?: string | null | undefined; }; user: { ...; } & { ...; }; }'.
  Types of property 'user' are incompatible.
    Type '{ id: string; createdAt: Date; updatedAt: Date; email: string; emailVerified: boolean; name: string; image?: string | null | undefined; }' is not assignable to type '{ id: string; createdAt: Date; updatedAt: Date; email: string; emailVerified: boolean; name: string; image?: string | null | undefined; } & { id: string; createdAt: Date; updatedAt: Date; ... 4 more ...; twoFactorEnabled: boolean | ... 1 more ... | undefined; }'.
      Property 'twoFactorEnabled' is missing in type '{ id: string; createdAt: Date; updatedAt: Date; email: string; emailVerified: boolean; name: string; image?: string | null | undefined; }' but required in type '{ id: string; createdAt: Date; updatedAt: Date; email: string; emailVerified: boolean; name: string; image?: string | null | undefined; twoFactorEnabled: boolean | null | undefined; }'. 
[36m	it('should create a note with japanese title and save the correct slug', async () => {
		vi.spyOn(authModule.auth.api, 'getSession').mockResolvedValueOnce([35mmockSession[36m);
		const noteTitle = 'Êó•Êú¨Ë™û„ÅÆÊñ∞„Åó„ÅÑ„Éé„Éº„Éà';[39m

c:\Users\toshimi.sato\program\sazanami\[32mtests\integration\notes-api.test.ts[39m:263:69
[31mError[39m: Argument of type '{ user: User; session: Session; }' is not assignable to parameter of type '{ session: { id: string; createdAt: Date; updatedAt: Date; userId: string; expiresAt: Date; token: string; ipAddress?: string | null | undefined; userAgent?: string | null | undefined; }; user: { ...; } & { ...; }; }'.
  Types of property 'user' are incompatible.
    Type '{ id: string; createdAt: Date; updatedAt: Date; email: string; emailVerified: boolean; name: string; image?: string | null | undefined; }' is not assignable to type '{ id: string; createdAt: Date; updatedAt: Date; email: string; emailVerified: boolean; name: string; image?: string | null | undefined; } & { id: string; createdAt: Date; updatedAt: Date; ... 4 more ...; twoFactorEnabled: boolean | ... 1 more ... | undefined; }'.
      Property 'twoFactorEnabled' is missing in type '{ id: string; createdAt: Date; updatedAt: Date; email: string; emailVerified: boolean; name: string; image?: string | null | undefined; }' but required in type '{ id: string; createdAt: Date; updatedAt: Date; email: string; emailVerified: boolean; name: string; image?: string | null | undefined; twoFactorEnabled: boolean | null | undefined; }'. 
[36m	it('should return 400 if note ID is missing in params', async () => {
		vi.spyOn(authModule.auth.api, 'getSession').mockResolvedValueOnce([35mmockSession[36m);
		const params = await createMockRequestHandlerParams([39m

c:\Users\toshimi.sato\program\sazanami\[32mtests\integration\notes-api.test.ts[39m:277:69
[31mError[39m: Argument of type '{ user: User; session: Session; }' is not assignable to parameter of type '{ session: { id: string; createdAt: Date; updatedAt: Date; userId: string; expiresAt: Date; token: string; ipAddress?: string | null | undefined; userAgent?: string | null | undefined; }; user: { ...; } & { ...; }; }'.
  Types of property 'user' are incompatible.
    Type '{ id: string; createdAt: Date; updatedAt: Date; email: string; emailVerified: boolean; name: string; image?: string | null | undefined; }' is not assignable to type '{ id: string; createdAt: Date; updatedAt: Date; email: string; emailVerified: boolean; name: string; image?: string | null | undefined; } & { id: string; createdAt: Date; updatedAt: Date; ... 4 more ...; twoFactorEnabled: boolean | ... 1 more ... | undefined; }'.
      Property 'twoFactorEnabled' is missing in type '{ id: string; createdAt: Date; updatedAt: Date; email: string; emailVerified: boolean; name: string; image?: string | null | undefined; }' but required in type '{ id: string; createdAt: Date; updatedAt: Date; email: string; emailVerified: boolean; name: string; image?: string | null | undefined; twoFactorEnabled: boolean | null | undefined; }'. 
[36m	it('should return 404 if note not found', async () => {
		vi.spyOn(authModule.auth.api, 'getSession').mockResolvedValueOnce([35mmockSession[36m);
		const nonExistentId = ulid();[39m

c:\Users\toshimi.sato\program\sazanami\[32mtests\integration\notes-api.test.ts[39m:293:69
[31mError[39m: Argument of type '{ user: User; session: Session; }' is not assignable to parameter of type '{ session: { id: string; createdAt: Date; updatedAt: Date; userId: string; expiresAt: Date; token: string; ipAddress?: string | null | undefined; userAgent?: string | null | undefined; }; user: { ...; } & { ...; }; }'.
  Types of property 'user' are incompatible.
    Type '{ id: string; createdAt: Date; updatedAt: Date; email: string; emailVerified: boolean; name: string; image?: string | null | undefined; }' is not assignable to type '{ id: string; createdAt: Date; updatedAt: Date; email: string; emailVerified: boolean; name: string; image?: string | null | undefined; } & { id: string; createdAt: Date; updatedAt: Date; ... 4 more ...; twoFactorEnabled: boolean | ... 1 more ... | undefined; }'.
      Property 'twoFactorEnabled' is missing in type '{ id: string; createdAt: Date; updatedAt: Date; email: string; emailVerified: boolean; name: string; image?: string | null | undefined; }' but required in type '{ id: string; createdAt: Date; updatedAt: Date; email: string; emailVerified: boolean; name: string; image?: string | null | undefined; twoFactorEnabled: boolean | null | undefined; }'. 
[36m	it('should update a note and re-generate the correct slug', async () => {
		vi.spyOn(authModule.auth.api, 'getSession').mockResolvedValueOnce([35mmockSession[36m);
		const updatedTitle = 'My Updated Test Note';[39m

c:\Users\toshimi.sato\program\sazanami\[32mtests\integration\notes-api.test.ts[39m:319:69
[31mError[39m: Argument of type '{ user: User; session: Session; }' is not assignable to parameter of type '{ session: { id: string; createdAt: Date; updatedAt: Date; userId: string; expiresAt: Date; token: string; ipAddress?: string | null | undefined; userAgent?: string | null | undefined; }; user: { ...; } & { ...; }; }'.
  Types of property 'user' are incompatible.
    Type '{ id: string; createdAt: Date; updatedAt: Date; email: string; emailVerified: boolean; name: string; image?: string | null | undefined; }' is not assignable to type '{ id: string; createdAt: Date; updatedAt: Date; email: string; emailVerified: boolean; name: string; image?: string | null | undefined; } & { id: string; createdAt: Date; updatedAt: Date; ... 4 more ...; twoFactorEnabled: boolean | ... 1 more ... | undefined; }'.
      Property 'twoFactorEnabled' is missing in type '{ id: string; createdAt: Date; updatedAt: Date; email: string; emailVerified: boolean; name: string; image?: string | null | undefined; }' but required in type '{ id: string; createdAt: Date; updatedAt: Date; email: string; emailVerified: boolean; name: string; image?: string | null | undefined; twoFactorEnabled: boolean | null | undefined; }'. 
[36m	it('should update a note with japanese title and re-generate the correct slug', async () => {
		vi.spyOn(authModule.auth.api, 'getSession').mockResolvedValueOnce([35mmockSession[36m);
		const updatedTitle = 'Êó•Êú¨Ë™û„ÅÆÊõ¥Êñ∞„Åï„Çå„Åü„Éé„Éº„Éà';[39m

c:\Users\toshimi.sato\program\sazanami\[32mtests\integration\resolve-link.test.ts[39m:163:69
[31mError[39m: Argument of type '{ user: { id: string; email: string; name: string; emailVerified: boolean; createdAt: Date; updatedAt: Date; }; session: { id: string; userId: string; expiresAt: Date; createdAt: Date; updatedAt: Date; token: string; }; }' is not assignable to parameter of type '{ session: { id: string; createdAt: Date; updatedAt: Date; userId: string; expiresAt: Date; token: string; ipAddress?: string | null | undefined; userAgent?: string | null | undefined; }; user: { ...; } & { ...; }; }'.
  Types of property 'user' are incompatible.
    Type '{ id: string; email: string; name: string; emailVerified: boolean; createdAt: Date; updatedAt: Date; }' is not assignable to type '{ id: string; createdAt: Date; updatedAt: Date; email: string; emailVerified: boolean; name: string; image?: string | null | undefined; } & { id: string; createdAt: Date; updatedAt: Date; ... 4 more ...; twoFactorEnabled: boolean | ... 1 more ... | undefined; }'.
      Property 'twoFactorEnabled' is missing in type '{ id: string; email: string; name: string; emailVerified: boolean; createdAt: Date; updatedAt: Date; }' but required in type '{ id: string; createdAt: Date; updatedAt: Date; email: string; emailVerified: boolean; name: string; image?: string | null | undefined; twoFactorEnabled: boolean | null | undefined; }'. 
[36m	it('should return 400 if title query parameter is missing', async () => {
		vi.spyOn(authModule.auth.api, 'getSession').mockResolvedValueOnce([35mmockSession[36m);[39m

c:\Users\toshimi.sato\program\sazanami\[32mtests\integration\resolve-link.test.ts[39m:177:69
[31mError[39m: Argument of type '{ user: { id: string; email: string; name: string; emailVerified: boolean; createdAt: Date; updatedAt: Date; }; session: { id: string; userId: string; expiresAt: Date; createdAt: Date; updatedAt: Date; token: string; }; }' is not assignable to parameter of type '{ session: { id: string; createdAt: Date; updatedAt: Date; userId: string; expiresAt: Date; token: string; ipAddress?: string | null | undefined; userAgent?: string | null | undefined; }; user: { ...; } & { ...; }; }'.
  Types of property 'user' are incompatible.
    Type '{ id: string; email: string; name: string; emailVerified: boolean; createdAt: Date; updatedAt: Date; }' is not assignable to type '{ id: string; createdAt: Date; updatedAt: Date; email: string; emailVerified: boolean; name: string; image?: string | null | undefined; } & { id: string; createdAt: Date; updatedAt: Date; ... 4 more ...; twoFactorEnabled: boolean | ... 1 more ... | undefined; }'.
      Property 'twoFactorEnabled' is missing in type '{ id: string; email: string; name: string; emailVerified: boolean; createdAt: Date; updatedAt: Date; }' but required in type '{ id: string; createdAt: Date; updatedAt: Date; email: string; emailVerified: boolean; name: string; image?: string | null | undefined; twoFactorEnabled: boolean | null | undefined; }'. 
[36m	it('should return correct note for an existing title', async () => {
		vi.spyOn(authModule.auth.api, 'getSession').mockResolvedValueOnce([35mmockSession[36m);[39m

c:\Users\toshimi.sato\program\sazanami\[32mtests\integration\resolve-link.test.ts[39m:192:69
[31mError[39m: Argument of type '{ user: { id: string; email: string; name: string; emailVerified: boolean; createdAt: Date; updatedAt: Date; }; session: { id: string; userId: string; expiresAt: Date; createdAt: Date; updatedAt: Date; token: string; }; }' is not assignable to parameter of type '{ session: { id: string; createdAt: Date; updatedAt: Date; userId: string; expiresAt: Date; token: string; ipAddress?: string | null | undefined; userAgent?: string | null | undefined; }; user: { ...; } & { ...; }; }'.
  Types of property 'user' are incompatible.
    Type '{ id: string; email: string; name: string; emailVerified: boolean; createdAt: Date; updatedAt: Date; }' is not assignable to type '{ id: string; createdAt: Date; updatedAt: Date; email: string; emailVerified: boolean; name: string; image?: string | null | undefined; } & { id: string; createdAt: Date; updatedAt: Date; ... 4 more ...; twoFactorEnabled: boolean | ... 1 more ... | undefined; }'.
      Property 'twoFactorEnabled' is missing in type '{ id: string; email: string; name: string; emailVerified: boolean; createdAt: Date; updatedAt: Date; }' but required in type '{ id: string; createdAt: Date; updatedAt: Date; email: string; emailVerified: boolean; name: string; image?: string | null | undefined; twoFactorEnabled: boolean | null | undefined; }'. 
[36m	it('should return 404 if note not found', async () => {
		vi.spyOn(authModule.auth.api, 'getSession').mockResolvedValueOnce([35mmockSession[36m);[39m

c:\Users\toshimi.sato\program\sazanami\[32mtests\integration\resolve-link.test.ts[39m:206:69
[31mError[39m: Argument of type '{ user: { id: string; email: string; name: string; emailVerified: boolean; createdAt: Date; updatedAt: Date; }; session: { id: string; userId: string; expiresAt: Date; createdAt: Date; updatedAt: Date; token: string; }; }' is not assignable to parameter of type '{ session: { id: string; createdAt: Date; updatedAt: Date; userId: string; expiresAt: Date; token: string; ipAddress?: string | null | undefined; userAgent?: string | null | undefined; }; user: { ...; } & { ...; }; }'.
  Types of property 'user' are incompatible.
    Type '{ id: string; email: string; name: string; emailVerified: boolean; createdAt: Date; updatedAt: Date; }' is not assignable to type '{ id: string; createdAt: Date; updatedAt: Date; email: string; emailVerified: boolean; name: string; image?: string | null | undefined; } & { id: string; createdAt: Date; updatedAt: Date; ... 4 more ...; twoFactorEnabled: boolean | ... 1 more ... | undefined; }'.
      Property 'twoFactorEnabled' is missing in type '{ id: string; email: string; name: string; emailVerified: boolean; createdAt: Date; updatedAt: Date; }' but required in type '{ id: string; createdAt: Date; updatedAt: Date; email: string; emailVerified: boolean; name: string; image?: string | null | undefined; twoFactorEnabled: boolean | null | undefined; }'. 
[36m	it('should return the latest updated note for duplicate titles', async () => {
		vi.spyOn(authModule.auth.api, 'getSession').mockResolvedValueOnce([35mmockSession[36m);[39m

c:\Users\toshimi.sato\program\sazanami\[32mtests\integration\resolve-link.test.ts[39m:220:69
[31mError[39m: Argument of type '{ user: { id: string; email: string; name: string; emailVerified: boolean; createdAt: Date; updatedAt: Date; }; session: { id: string; userId: string; expiresAt: Date; createdAt: Date; updatedAt: Date; token: string; }; }' is not assignable to parameter of type '{ session: { id: string; createdAt: Date; updatedAt: Date; userId: string; expiresAt: Date; token: string; ipAddress?: string | null | undefined; userAgent?: string | null | undefined; }; user: { ...; } & { ...; }; }'.
  Types of property 'user' are incompatible.
    Type '{ id: string; email: string; name: string; emailVerified: boolean; createdAt: Date; updatedAt: Date; }' is not assignable to type '{ id: string; createdAt: Date; updatedAt: Date; email: string; emailVerified: boolean; name: string; image?: string | null | undefined; } & { id: string; createdAt: Date; updatedAt: Date; ... 4 more ...; twoFactorEnabled: boolean | ... 1 more ... | undefined; }'.
      Property 'twoFactorEnabled' is missing in type '{ id: string; email: string; name: string; emailVerified: boolean; createdAt: Date; updatedAt: Date; }' but required in type '{ id: string; createdAt: Date; updatedAt: Date; email: string; emailVerified: boolean; name: string; image?: string | null | undefined; twoFactorEnabled: boolean | null | undefined; }'. 
[36m	it('should handle Japanese titles correctly', async () => {
		vi.spyOn(authModule.auth.api, 'getSession').mockResolvedValueOnce([35mmockSession[36m);[39m

c:\Users\toshimi.sato\program\sazanami\[32mtests\integration\signup.test.ts[39m:58:16
[31mError[39m: Property 'data' does not exist on type 'NonNullable<{ token: null; user: { id: string; email: string; name: string; image: string | null | undefined; emailVerified: boolean; createdAt: Date; updatedAt: Date; }; } | { token: string; user: { ...; }; }>'.
  Property 'data' does not exist on type '{ token: null; user: { id: string; email: string; name: string; image: string | null | undefined; emailVerified: boolean; createdAt: Date; updatedAt: Date; }; }'. 
[36m		expect(data).toBeDefined();
		expect(data?.[35mdata[36m.user.email).toBe(newUser.email);
		expect(data?.data.user.name).toBe(newUser.name);[39m

c:\Users\toshimi.sato\program\sazanami\[32mtests\integration\signup.test.ts[39m:59:16
[31mError[39m: Property 'data' does not exist on type 'NonNullable<{ token: null; user: { id: string; email: string; name: string; image: string | null | undefined; emailVerified: boolean; createdAt: Date; updatedAt: Date; }; } | { token: string; user: { ...; }; }>'.
  Property 'data' does not exist on type '{ token: null; user: { id: string; email: string; name: string; image: string | null | undefined; emailVerified: boolean; createdAt: Date; updatedAt: Date; }; }'. 
[36m		expect(data?.data.user.email).toBe(newUser.email);
		expect(data?.[35mdata[36m.user.name).toBe(newUser.name);[39m

====================================
[31msvelte-check found 66 errors and 2 warnings in 17 files
[39m